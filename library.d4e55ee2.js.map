{"mappings":"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","sources":["src/js/modal-library.js"],"sourcesContent":["import axios from 'axios';\nimport { createWatchedList, libraryMarkup } from './library-localStorage';\nimport {\n  refs,\n  createWatchedList,\n  createQueueList,\n} from './library-localStorage';\nexport const BASE_URL = 'https://api.themoviedb.org/3';\nexport const USER_KEY = '9e4f0ad78cbe1148a9d4c0c8389afc83';\nexport const prePoster = 'https://image.tmdb.org/t/p/original/';\nconst libraryEl = document.querySelector('.library-list');\nconst backDropEl = document.querySelector('.backdrop');\nconst modalContentEl = document.querySelector('.modal');\nlet markup = '';\nlibraryEl.addEventListener('click', onOpenModalLibrary);\n\nfunction getMovieID(event) {\n  event.preventDefault();\n  if (event.currentTarget === event.target) {\n    return;\n  }\n  const list = event.target.closest('li');\n  const listId = list.dataset.id;\n  return listId;\n}\n\nasync function fetchMovie(movie_id) {\n  try {\n    const { data } = await axios.get(\n      `${BASE_URL}/movie/${movie_id}?api_key=${USER_KEY}&language=en-US`\n    );\n    return data;\n  } catch (error) {\n    console.log(error.message);\n  }\n}\n\nasync function onButtonWatched(event) {\n  const watchedBtn = document.querySelector('.js-watchedBtn');\n  const filmId = event.target.dataset.id;\n  const watchedStatus = JSON.parse(localStorage.getItem('addToWatched')).find(\n    film => film.id === Number(filmId)\n  );\n  console.log('watched status', watchedStatus);\n  if (watchedStatus) {\n    watchedBtn.textContent = 'ADD TO WATCHED';\n    const watchedStorage = JSON.parse(\n      localStorage.getItem('addToWatched')\n    ).filter(film => film.id !== Number(filmId));\n    localStorage.setItem('addToWatched', JSON.stringify(watchedStorage));\n  } else {\n    watchedBtn.textContent = 'REMOVE FROM WATCHED';\n    const watchedStorage = JSON.parse(localStorage.getItem('addToWatched'));\n\n    const searchedFilmInfo = await fetchMovie(filmId);\n    const poster = searchedFilmInfo.poster_path;\n    const title = searchedFilmInfo.original_title\n      ? searchedFilmInfo.original_title\n      : searchedFilmInfo.title;\n    const genreList = searchedFilmInfo.genres\n      .map(genre => genre.name)\n      .join(', ');\n\n    const releaseDate = searchedFilmInfo.release_date.slice(0, 4);\n    const id = searchedFilmInfo.id;\n    const watchedLibrary = { poster, title, genreList, releaseDate, id };\n    watchedStorage.push(watchedLibrary);\n\n    localStorage.setItem('addToWatched', JSON.stringify(watchedStorage));\n  }\n  refs.watchedBtn.classList.add('active');\n  refs.queueBtn.classList.remove('active');\n  location.reload();\n}\n\nasync function onButtonQueue(event) {\n  const queueBtn = document.querySelector('.js-queueBtn');\n  const filmId = event.target.dataset.id;\n  const queueStatus = JSON.parse(localStorage.getItem('addToQueue')).find(\n    film => film.id === Number(filmId)\n  );\n\n  if (queueStatus) {\n    queueBtn.textContent = 'ADD TO QUEUE';\n    const queueStorage = JSON.parse(localStorage.getItem('addToQueue')).filter(\n      film => film.id !== Number(filmId)\n    );\n    localStorage.setItem('addToQueue', JSON.stringify(queueStorage));\n  } else {\n    queueBtn.textContent = 'REMOVE FROM QUEUE';\n    const queueStorage = JSON.parse(localStorage.getItem('addToQueue'));\n\n    const searchedFilmInfo = await fetchMovie(filmId);\n    const poster = searchedFilmInfo.poster_path;\n    const title = searchedFilmInfo.original_title\n      ? searchedFilmInfo.original_title\n      : searchedFilmInfo.title;\n    const genreList = searchedFilmInfo.genres\n      .map(genre => genre.name)\n      .join(', ');\n\n    const releaseDate = searchedFilmInfo.release_date.slice(0, 4);\n    const id = searchedFilmInfo.id;\n    const queueLibrary = { poster, title, genreList, releaseDate, id };\n    queueStorage.push(queueLibrary);\n\n    localStorage.setItem('addToQueue', JSON.stringify(queueStorage));\n  }\n  refs.watchedBtn.classList.add('active');\n  refs.queueBtn.classList.remove('active');\n  location.reload();\n}\n\nasync function onOpenModalLibrary(event) {\n  const filmId = getMovieID(event);\n  const filmData = await fetchMovie(filmId);\n  const watchedArray = localStorage.getItem('addToWatched');\n  const queueArray = localStorage.getItem('addToQueue');\n\n  const watchedStatus = JSON.parse(watchedArray).find(\n    film => film.id === Number(filmId)\n  );\n  const queueStatus = JSON.parse(queueArray).find(\n    film => film.id === Number(filmId)\n  );\n  const watchedButtonContent = watchedStatus\n    ? 'REMOVE FROM WATCHED'\n    : 'ADD TO WATCHED';\n\n  const queueButtonContent = queueStatus ? 'REMOVE FROM QUEUE' : 'ADD TO QUEUE';\n\n  movieModalLibraryRender(filmData, watchedButtonContent, queueButtonContent);\n  const closeBtnEl = document.querySelector('.modal-close');\n  closeBtnEl.addEventListener('click', onModalClose);\n  document.addEventListener('keydown', e => {\n    if (e.keyCode === 27) {\n      onModalClose();\n    }\n  });\n  backDropEl.addEventListener('click', e => {\n    if (e.target === e.currentTarget) {\n      onModalClose();\n    }\n  });\n  const watchedBtn = document.querySelector('.js-watchedBtn');\n  const queueBtn = document.querySelector('.js-queueBtn');\n  watchedBtn.addEventListener('click', onButtonWatched);\n  queueBtn.addEventListener('click', onButtonQueue);\n}\n\nfunction onModalClose() {\n  backDropEl.classList.add('visually-hidden');\n  //movieToFind = {};\n  modalContentEl.innerHTML = '';\n  markup = '';\n}\n\nfunction movieModalLibraryRender(\n  filmData,\n  watchedButtonContent,\n  queueButtonContent\n) {\n  modalContentEl.innerHTML = '';\n  backDropEl.classList.remove('visually-hidden');\n\n  const {\n    poster_path,\n    original_title,\n    name,\n    vote_average,\n    vote_count,\n    popularity,\n    genres,\n    release_date = '',\n    first_air_date = '',\n    overview,\n    id,\n  } = filmData;\n\n  const movieName = original_title ? original_title : name;\n  const date = release_date\n    ? release_date.slice(0, 4)\n    : first_air_date.slice(0, 4);\n  const genreList = genres.map(genre => genre.name).join(', ');\n\n  const icon = `<svg\n      width=\"30\"\n      height=\"30\"\n      viewBox=\"0 0 30 30\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path d=\"M8 8L22 22\" stroke=\"black\" stroke-width=\"2\" />\n      <path d=\"M8 22L22 8\" stroke=\"black\" stroke-width=\"2\" />\n    </svg>`;\n\n  markup = `\n   <button type=\"button\" class=\"modal-close\" data-modal-close>\n    ${icon}\n  </button>\n  <div class=\"modal-poster\"><img\n      class=\"img-film\"\n      src=\"${prePoster}${poster_path}\"\n      alt=\"\"\n    />\n  </div>\n  <div class=\"modal-description\">\n    <h2 class=\"modal-title\">${movieName}</h2>\n    <div class=\"data-wrapper\">\n      <div class=\"data-keys\">\n        <ul class=\"keys-list\">\n          <li class=\"keys-item\">Vote / Votes</li>\n          <li class=\"keys-item\">Popularity</li>\n          <li class=\"keys-item\">Original Title</li>\n          <li class=\"keys-item\">Genre</li>\n        </ul>\n      </div>\n      <div class=\"data-values\">\n        <ul class=\"values-list\">\n          <li class=\"value-item\">\n            <span class=\"rating\">${vote_average}</span>/<span class=\"votes\">${vote_count}</span>\n          </li>\n          <li class=\"value-item popularity\">${popularity}</li>\n          <li class=\"value-item movie-title\">${movieName}</li>\n          <li class=\"value-item movie-genres\">${genreList}</li>\n        </ul>\n      </div>\n    </div>\n    <h2 class=\"about-film\">ABOUT</h2>\n    <p class=\"description-film-info\">${overview} \n    </p>\n    <div class=\"btn-block\">\n      <button type=\"button\" class=\"modal-button js-watchedBtn\" data-id='${id}'>${watchedButtonContent}</button>\n      <button type=\"button\" class=\"modal-button js-queueBtn\" data-id='${id}'>${queueButtonContent}</button>\n    </div>\n  </div>`;\n\n  modalContentEl.insertAdjacentHTML('afterbegin', markup);\n}\n"],"names":["$2shzp","parcelRequire","$2631b5b1e00936b8$var$libraryEl","document","querySelector","$2631b5b1e00936b8$var$backDropEl","$2631b5b1e00936b8$var$modalContentEl","$2631b5b1e00936b8$var$markup","async","$2631b5b1e00936b8$var$fetchMovie","movie_id","data","default","get","error","console","log","message","$2631b5b1e00936b8$var$onButtonWatched","event","watchedBtn","filmId","target","dataset","id","watchedStatus","JSON","parse","localStorage","getItem","find","film","Number","textContent","watchedStorage","filter","setItem","stringify","searchedFilmInfo","watchedLibrary","poster_path","original_title","title","genres","map","genre","name","join","release_date","slice","push","$6VKYe","refs","classList","add","queueBtn","remove","location","reload","$2631b5b1e00936b8$var$onButtonQueue","queueStorage","queueLibrary","$2631b5b1e00936b8$var$onModalClose","innerHTML","addEventListener","preventDefault","currentTarget","list","closest","$2631b5b1e00936b8$var$getMovieID","filmData","watchedArray","queueArray","queueStatus","watchedButtonContent","queueButtonContent","vote_average","vote_count","popularity","first_air_date","overview","movieName","genreList","insertAdjacentHTML","$2631b5b1e00936b8$var$movieModalLibraryRender","e","keyCode"],"version":3,"file":"library.d4e55ee2.js.map"}